/* eslint-disable */
(()=>{"use strict";new class{constructor(){this.log=!1,this.event=["click"],this.port="",this.portData={}}_handleListenClick(e){if(this.log&&console.log("事件元素——————",e),e.path&&e.path.length)try{this._handleIsSend(e)}catch(e){console.error("运行错误——————",e)}else console.error("请检查元素path格式——————",e.path)}_handleIsSend(e){this._handleCreatePath(e)}_handleCreatePath(e){let t="",o=location.origin+location.pathname||"",n=location.hash||"";n&&(n=`${-1===n.indexOf("?")?n:n.substr(0,n.indexOf("?"))}/`),e.path.every((e=>{if(!e.nodeName||"BODY"===e.nodeName||"HTML"===e.nodeName||"#document"===e.nodeName)return!1;let o="",n="";if(e.id)o=`*[@id=${e.id}]`;else if(e.classList&&e.classList.length){let t=e.classList[0];if(e.parentNode&&e.parentNode.childNodes&&e.parentNode.childNodes.length){let o=0,s={};e.parentNode.childNodes.forEach((n=>{n.classList&&n.classList.length&&n.classList.forEach((t=>{-1!==e.classList.value.indexOf(t)&&(s[t]=s[t]?s[t]+1:1)}));let i=Object.values(s);if(i.length){const e=Math.max.apply(null,i);o=e;for(let o in s)if(e===s[o])return void(t=o)}}));let i=0;e.parentNode.childNodes.forEach((s=>{s.classList&&s.classList.length&&-1!==s.classList.value.indexOf(t)&&i++,s===e&&o>1&&i>=0&&(n=`[${i}]`)}))}o=`.${t}${n}`}else{if(e.parentNode&&e.parentNode.childNodes&&e.parentNode.childNodes.length){let t=0;e.parentNode.childNodes.forEach((o=>{o.nodeName===e.nodeName&&t++,o===e&&t&&(n=`[${t}]`)}))}o=e.nodeName+n}return t=`${o}/${t}`,!0})),this.portData={d:o+n,s:t},this._port()}_handleInitParams(e){"[object Boolean]"===Object.prototype.toString.call(e.log)&&(this.log=e.log),"[object String]"===Object.prototype.toString.call(e.port)&&(this.port=e.port)}_port(){if(!this.port)return void console.info("_port——无接口数据");const e=JSON.stringify(this.portData);this.log&&console.info("%c自动化埋点统计上报数据：","color:#b8920c;",e),"sendBeacon"in navigator&&navigator.sendBeacon(this.port,e)?console.info("_port——成功进入浏览器请求队列"):fetch(this.port,{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:e}).then((e=>{console.log(e)})).catch((e=>{console.log(e)}))}init(e={}){this._handleInitParams(e);const t=e=>{this._handleListenClick(e)};this.event.forEach((e=>{window.addEventListener(e,t,!1),window.addEventListener("pagehide",(()=>{window.removeEventListener(e,t,!1)})),window.addEventListener("unload",(()=>{window.removeEventListener(e,t,!1)}))})),this.log&&(window.onbeforeunload=()=>"调试呢，先别跳")}}})();